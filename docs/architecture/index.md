# HaiGo 架构说明（PoC v0）

## Epic 1 Deliverables Overview
- ✅ [链上注册与订单骨架](./3-链上合约设计.md): Registry/Orders/Staking 模块已实装，文档按“已交付 vs 规划”拆分。
- ✅ [链下账户索引与 BFF API](./4-链下服务与数据流.md): 事件监听、Prisma 模型与 REST 接口同步。
- ✅ [前端注册体验与环境变量](./5-前端体验.md) → 详细交互参见 `docs/front-end-spec.md#epic-1-context--alignment`。
- 🛠️ Roadmap：Epic 2/3 的订单、媒体、理赔扩展已在各章节标注“Planned”部分，便于后续更新。


## Table of Contents

- [HaiGo 架构说明（PoC v0）](#table-of-contents)
  - [Introduction](./introduction.md)
    - [Starter Template or Existing Project](./introduction.md#starter-template-or-existing-project)
    - [Change Log](./introduction.md#change-log)
  - [High Level Architecture](./high-level-architecture.md)
    - [Technical Summary](./high-level-architecture.md#technical-summary)
    - [Platform and Infrastructure Choice](./high-level-architecture.md#platform-and-infrastructure-choice)
    - [Repository Structure](./high-level-architecture.md#repository-structure)
  - [1. 架构目标与范围](./1-架构目标与范围.md)
  - [2. 系统分层概览](./2-系统分层概览.md)
    - [2.1 全栈交互示意图](./2-系统分层概览.md#21-全栈交互示意图)
  - [3. 链上合约设计](./3-链上合约设计.md)
    - [3.1 Registry 模块](./3-链上合约设计.md#31-registry-模块)
      - [状态结构](./3-链上合约设计.md#状态结构)
      - [关键入口函数](./3-链上合约设计.md#关键入口函数)
      - [约束与交互](./3-链上合约设计.md#约束与交互)
    - [3.2 Orders 模块](./3-链上合约设计.md#32-orders-模块)
      - [状态结构](./3-链上合约设计.md#状态结构-1)
      - [状态机流程](./3-链上合约设计.md#状态机流程)
      - [约束与交互](./3-链上合约设计.md#约束与交互-1)
      - [事件载荷](./3-链上合约设计.md#事件载荷)
    - [3.3 Staking 模块](./3-链上合约设计.md#33-staking-模块)
      - [状态结构](./3-链上合约设计.md#状态结构-2)
      - [关键入口函数](./3-链上合约设计.md#关键入口函数-1)
      - [约束与交互](./3-链上合约设计.md#约束与交互-2)
    - [3.4 规划模块（Insurance / Reputation）](./3-链上合约设计.md#34-规划模块insurance--reputation)
    - [3.5 模块交互与依赖关系](./3-链上合约设计.md#35-模块交互与依赖关系)
    - [3.6 权限与安全控制](./3-链上合约设计.md#36-权限与安全控制)
    - [3.7 事件与索引策略](./3-链上合约设计.md#37-事件与索引策略)
    - [3.8 测试与部署](./3-链上合约设计.md#38-测试与部署)
      - [3.2.4 媒体存证字段与约束](./3-链上合约设计.md#324-媒体存证字段与约束)
      - [3.2.5 费用与支付约束](./3-链上合约设计.md#325-费用与支付约束)
      - [3.2.6 Story 对齐清单](./3-链上合约设计.md#326-story-对齐清单)
      - [3.2.7 测试覆盖](./3-链上合约设计.md#327-测试覆盖)
      - [3.2.8 与链下协作要点](./3-链上合约设计.md#328-与链下协作要点)
  - [4. 链下服务与数据流](./4-链下服务与数据流.md)
    - [4.1 当前交付范围（Epic 1）](./4-链下服务与数据流.md#41-当前交付范围epic-1)
      - [4.1.1 架构概览](./4-链下服务与数据流.md#411-架构概览)
      - [4.1.2 事件轮询 & 游标管理](./4-链下服务与数据流.md#412-事件轮询--游标管理)
      - [4.1.3 事件映射](./4-链下服务与数据流.md#413-事件映射)
    - [4.2 数据模型（Prisma / Postgres）](./4-链下服务与数据流.md#42-数据模型prisma--postgres)
    - [4.3 REST API（已实现）](./4-链下服务与数据流.md#43-rest-api已实现)
    - [4.4 核心模块](./4-链下服务与数据流.md#44-核心模块)
    - [4.5 配置与环境变量](./4-链下服务与数据流.md#45-配置与环境变量)
    - [4.6 运行与测试](./4-链下服务与数据流.md#46-运行与测试)
    - [4.7 Roadmap：订单与媒体流水线](./4-链下服务与数据流.md#47-roadmap订单与媒体流水线)
      - [4.7.1 订单数据摄入（规划）](./4-链下服务与数据流.md#471-订单数据摄入规划)
      - [4.7.2 媒体存证与上传接口（规划）](./4-链下服务与数据流.md#472-媒体存证与上传接口规划)
      - [4.7.3 理赔与评分（规划）](./4-链下服务与数据流.md#473-理赔与评分规划)
      - [4.7.4 Roadmap 依赖](./4-链下服务与数据流.md#474-roadmap-依赖)
  - [5. 前端体验](./5-前端体验.md) — Epic 1 已交付注册体验，余下功能标记为 Planned
  - [6. 部署与环境](./6-部署与环境.md)
    - [6.1 本地 Docker PoC 环境（Postgres + Hasura）](./6-部署与环境.md#61-本地-docker-poc-环境postgres-hasura)
      - [6.1.1 前置依赖](./6-部署与环境.md#611-前置依赖)
      - [6.1.2 Compose 模板](./6-部署与环境.md#612-compose-模板)
      - [6.1.3 启动与健康检查](./6-部署与环境.md#613-启动与健康检查)
      - [6.1.4 数据初始化](./6-部署与环境.md#614-数据初始化)
      - [6.1.5 常见问题](./6-部署与环境.md#615-常见问题)
      - [6.1.6 Epic 2 附加组件：订单监听与媒体存储](./6-部署与环境.md#616-epic-2-附加组件订单监听与媒体存储)
    - [6.2 宿主机运行 BFF 与 Web](./6-部署与环境.md#62-宿主机运行-bff-与-web)
      - [6.2.1 Epic 2 运行参数与服务约定](./6-部署与环境.md#621-epic-2-运行参数与服务约定)
    - [6.3 测试网环境](./6-部署与环境.md#63-测试网环境)
      - [6.3.1 Move 模块部署（Story 2.1）](./6-部署与环境.md#631-move-模块部署story-21)
      - [6.3.2 媒体存储与对象服务（Story 2.3）](./6-部署与环境.md#632-媒体存储与对象服务story-23)
      - [6.3.3 订单索引与监控（Story 2.4）](./6-部署与环境.md#633-订单索引与监控story-24)
    - [6.4 CI/CD](./6-部署与环境.md#64-cicd)
      - [6.4.1 Epic 2 持续集成要求](./6-部署与环境.md#641-epic-2-持续集成要求)
    - [6.5 基础设施即代码](./6-部署与环境.md#65-基础设施即代码)
      - [6.5.1 Epic 2 补充资源](./6-部署与环境.md#651-epic-2-补充资源)
    - [6.6 Epic 2 验收检查表（部署视角）](./6-部署与环境.md#66-epic-2-验收检查表部署视角)
  - [7. 安全、合规与运维](./7-安全合规与运维.md)
  - [8. 演进路线](./8-演进路线.md)
  - [9. 附件](./9-附件.md)
